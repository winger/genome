\chapter{Описание текущих используемых подходов к задаче секвенирования} 
\label{chapter2}

\section{Формулировки задачи секвенирования методом дробовика}

Задача секвенирования формулируется следующим образом: имеется набор строк (чтений), полученных
каким-либо способом чтения ДНК. Требуется получить как можно больше сведений об изучаемой
последовательности (в идеальном случае~--- восстановить полную последовательность нуклеотидов).

В варианте задачи, изучаемом в данной работе, известна также информация о парах~--- известны
попарные соответствия между чтениями, прочитанными с двух концов одного фрагмента.

Неформальную формулировку задачи можно формализовать несколькими способами.

\subsection{Формулировка в виде задачи о наименьшей надстроке}

Дано множество строк ${x_i}$. Требуется найти минимальную по длине строку $s$ такую, 
что все $x_i$ входят в нее в качестве подстроки.

Данная задача является $\mathcal{NP}$-полной, следовательно маловероятно что у нее
существует достаточно эффективное решение.

%TODO: ссылки

\subsection{Формулировка задачи как поиск гамильтонова пути}

Дано множество строк ${x_i}$. Рассмотрим следующий ориентированный граф $G$: каждая его вершина $v_i$
соответствует чтению $x_i$, каждое ребро $(v_i, v_j)$~--- перекрытию между строками $x_i$ и $x_j$.
В графе $G$ требуется найти гамильтонов путь~--- путь, проходящий через каждую вершину ровно один раз.

Как и задача о наименьшей надстроке, данная задача $\mathcal{NP}$-полна.

\subsection{Формулировка задачи как поиск эйлерова пути}

Дано множество строк ${x_i}$. Рассмотрим множество всех строк ${y_i}$ длиной $k$, входящих в $x_i$
как подстроки. Рассмотрим следующий ориентированный граф $G$ (\figurename\ref{euler1}): его вершины соответствуют всем
возможным строкам длины $k-1$, каждое ребро соответствует строке $y_i$ и идет из вершины, соответствующей
префиксу $y_i$ в вершину, соответствующую суффиксу. Заметим, что этот граф~--- подграф графа де Брейна
порядка $k$, содержащего все возможные ребра данного вида. В этом графе требуется найти эйлеров путь~---
путь, проходящий через каждое ребро ровно один раз.

\begin{figure}[h]
\center{
\includegraphics{pic/euler.svg.eps}
}
\caption{Пример графа де Брейна. Эйлеровому пути соответствует строка ACGCGT.}
\label{euler1}
\end{figure}

Данная задача имеет эффективные полиномиальные решения.

\section{Алгоритмы решения задачи секвенирования методом дробовика}

На основе различных формализаций задачи базируются алгоритмы решения задачи:

\subsection{Алгоритмы на основе поиска эйлерова пути}

Строится граф де Брейна, соответствующий формулировке задачи. После этого в нем ищется эйлеров путь одним
из известных эффективных алгоритмов.

Данный метод используют следующие системы секвенирования: EULER, Velvet, ABySS

\subsection{Алгоритмы на основе жадного решения задачи о наименьшей надстроке}

В связи с тем, что задача о наименьшей надстроке $\mathcal{NP}$-полна, на данный момент не
известно эффективных методов ее решения. Тем не менее, существует простой жадный алгоритм,
дающий неплохие результаты на практике.

Данный метод используют следующие системы: ?%TODO

\subsection{Алгоритм overlap-layout-consensus}

Алгоритм overlap-layout-consensus использует различные эвристические методы решения задачи о
гамильтоновом пути.

Данный метод используют следующие системы: Newbler, Celera, Arachne

\section{Обработка ошибок чтения}

В связи с тем, что исходные данные получают из эксперимента, в них обязательно присутствуют ошибки.
Для получения корректных результатов, применяются различные методики их исправления.

\subsection{Эвристические методы удаления ошибочных данных}

Большинство существующих систем используют различные эвристические подходы для удаления 
ошибочных чтений. Обычно это различные методики анализа графа де Брейна либо графа
наложений.

\section{Структура систем секвенирования}

Большинство существующих систем секвенирования построены по следующей схеме:

\begin{enumerate}
\item Фильтрация ошибочных чтений
\item Решение задачи секвенирования методом дробовика для отдельных чтений (на выходе контиги)
\item Синтез контигов в более длинные последовательности за счет использования paired-end данных ({\it англ.} scaffolding)
\end{enumerate}

\subsection{Использование paired-end данных ({\it англ.} scaffolding)}

Большинство методов дает на выходе набор контигов. После этого контиги объединяются в более
длинные последовательности используя данные о парах. Для этого строится граф с вершинами соответсвующими
контигам и ребрами между ними с весами, равными количеству пар, которые эти контиги объединяют.
Затем к этому графу применяется алгоритм, сходный с алгоритмом overlap-layout-consensus.

%\section{Обзор существующих систем секвенирования}

%[TODO]

%\section{Выводы по главе \protect\ref{chapter2}}
